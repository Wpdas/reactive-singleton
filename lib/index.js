Object.defineProperty(exports,"__esModule",{value:!0});var t,e=require("react"),n=(t=e)&&"object"==typeof t&&"default"in t?t.default:t,s=function(){return(s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r={},u=function(t){return r[t]},o={},i=function(t){return o[t]},a={status:"ready"},c=e.createContext(a),f=function(){function t(){this.observers=[]}return t.prototype.subscribe=function(t){this.observers.push(t)},t.prototype.unsubbscribe=function(t){this.observers=this.observers.filter((function(e){return e!==t}))},t.prototype.notify=function(t){this.observers.forEach((function(e){return e(t)}))},t}(),l=function(){function t(){var t,e,n;this.status="ready",this.key="_"+Math.random().toString(36).substr(2,9),t=this.key,e=new f,r=s(s({},r),((n={})[t]=e,n))}return t.prototype.setValue=function(t){var e=t;this.singletonClass=e},t.prototype.getProps=function(){return{singleton:this.singletonClass,status:this.status,key:this.key}},t}();function b(t){e.useContext(c);var n=function(t){var e=t.name,n=i(e);if(!n)throw new Error(e+" singleton was not correctly initialized or doesn't exist! Please, create your Singleton using createSingleton()'s setValue.");var s=n.getProps(),r=s.singleton,o=s.status,a=s.key;return{singleton:r,status:o,observable:u(a)}}(t);return{status:n.status,statusObservable:n.observable}}exports.SingletonProvider=function(t){var s=t.children,f=e.useState(a.status),l=f[0],b=f[1];return e.useEffect((function(){Object.keys(r).forEach((function(t){u(t).subscribe((function(t){setTimeout((function(){l===t&&b("next_status"),b(t)}),0)}))}))}),[]),e.useEffect((function(){Object.keys(o).forEach((function(t){var e=i(t);"ready"!==e.status&&b(e.status)}))}),[]),n.createElement(c.Provider,{value:{status:l}},s)},exports.createSingleton=function(){var t=new l;return{useWatcher:function(e){var n=u(t.key);t.status="in_progress",n.notify(t.status),e((function(){t.status="ready",n.notify(t.status)}))},setValue:function(e){var n,r,u;t.setValue(e),n=e.name,r=t,o=s(s({},o),((u={})[n]=r,u))}}},exports.useSingletonStatus=function(t){return b(t).status},exports.useWasDataUpdated=function(t,n){void 0===n&&(n=500);var s=function(t){return b(t).statusObservable}(t),r=e.useState(!1),u=r[0],o=r[1],i=function(t,n){var s=e.useState(t),r=s[0],u=s[1];return e.useEffect((function(){var e=setTimeout((function(){u(t)}),n);return function(){clearTimeout(e)}}),[t,n]),r}(u,n);return e.useEffect((function(){var t=function(e){"ready"===e&&(o(!0),s.unsubbscribe(t))};return s.subscribe(t),function(){s.unsubbscribe(t)}}),[]),i};
