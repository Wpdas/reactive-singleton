Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react");function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t),r=function(){function t(){this.observers=[]}return t.prototype.subscribe=function(t){this.observers.push(t)},t.prototype.unsubscribe=function(t){this.observers=this.observers.filter((function(e){return e!==t}))},t.prototype.notify=function(t){this.observers.forEach((function(e){return e(t)}))},t}(),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)},u={},o=function(t){return u[t]},i=function(){function t(){var t,e,n;this.status="ready",this.key="_"+Math.random().toString(36).substr(2,9),t=this.key,e=new r,u=s(s({},u),((n={})[t]=e,n))}return t.prototype.setClass=function(t){var e=t;this.singletonClass=e},t.prototype.getProps=function(){return{singleton:this.singletonClass,status:this.status,key:this.key}},t}(),a={};function c(t){var e=t.name,n=function(t){return a[t]}(e);if(!n)throw new Error(e+" singleton was not correctly initialized or doesn't exist! Please, create your Singleton using the createSingleton() feature: setClass.");var r=n.getProps(),s=r.singleton,u=r.status,i=r.key;return{singleton:s,status:u,observable:o(i)}}function f(e){var n=c(e),r=n.status,s=n.observable,u=t.useState(r),o=u[0],i=u[1];return t.useEffect((function(){var t=function(t){setTimeout((function(){i(t)}),0)};return s.subscribe(t),function(){s.unsubscribe(t)}}),[s,o]),o}function l(t){f(t)}exports.createSingleton=function(){var t=new i;return{watch:function(e){var n=o(t.key);t.status="in_progress",n.notify(t.status),e((function(){t.status="ready",n.notify(t.status)}))},setClass:function(e){var n,r,u;t.setClass(e),n=e.name,r=t,a=s(s({},a),((u={})[n]=r,u))}}},exports.useReRenderOnUpdate=l,exports.useSingletonStatus=f,exports.useWasDataUpdated=function(e,n){void 0===n&&(n=500);var r=c(e).observable,s=t.useState(!1),u=s[0],o=s[1],i=function(e,n){var r=t.useState(e),s=r[0],u=r[1];return t.useEffect((function(){var t=setTimeout((function(){u(e)}),n);return function(){clearTimeout(t)}}),[e,n]),s}(u,n);return t.useEffect((function(){var t=function(e){"ready"===e&&(o(!0),r.unsubscribe(t))};return r.subscribe(t),function(){r.unsubscribe(t)}}),[r]),i},exports.withSingleton=function(t,e){return function(r){return l(e),n.default.createElement(t,s({},r))}};
